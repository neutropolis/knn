  Split←{
     ⍵⍵:⍪⌿(⍺⍺ ∇∇ 0∘⍵⍤2)⍺[⊢⌸,¯1↑[2]⍺;] ⍝ stratify: recursive split for each group
     delim←(sz←≢⍺)×⍵÷+/⍵              ⍝ delimiters for each subset
     adj←pre,sz-+/pre←¯1↓⌊delim       ⍝ adjustment: last subset assumes fractions
     pos←(adj\⍳≢⍵)⊆⍺⍺ sz              ⍝ generate & get positions for each partition
     (⌷∘⍺⊂)¨pos                       ⍝ finally, record indexing
 }
